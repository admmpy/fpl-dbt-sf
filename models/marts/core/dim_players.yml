version: 2

models:
    - name: dim_players
      description: Player table showing latest player details and value
      columns:
       - name: player_id
         description: Player identifier (Primary Key)
         tests:
         - not_null
         - unique
       - name: position_id
         description: Player position identifier
         tests:
         - not_null
         - relationships:
             arguments:
               to: ref('dim_positions')
               field: position_id
       - name: team_id
         description: Player team identifier
         tests:
         - not_null
         - relationships:
             arguments:
               to: ref('dim_teams')
               field: team_id
       - name: first_name
         description: Player first name
         tests:
         - not_null
       - name: second_name
         description: Player second name
         tests:
         - not_null
       - name: web_name
         description: Player web name
         tests:
         - not_null
       - name: current_value
         description: Player value
         tests:
         - not_null
         - dbt_utils.expression_is_true:
             arguments:
               expression: ">= 0"

